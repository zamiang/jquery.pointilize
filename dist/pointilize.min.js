/*! jQuery.pointilize - v0.1.0 - 2013-04-21
* http://zamiang.github.com/jquery.pointilize
* Copyright (c) 2013 Brennan Moore; Licensed MIT */
(function(){(function(e,t,n){return t.Pointilize=function(){function n(){}return n.prototype.mouse={x:-1,y:-1},n.prototype.cellSize=3,n.prototype.brushSize=2,n.prototype.incriment=4,n.prototype.initialize=function(e){if(!e)throw"You must pass options";if(!e.imgSrc)throw"You must pass imgSrc";return this.imgSrc=e.imgSrc,this.docWidth=jQuery(t).width(),this.docHeight=jQuery(t).height(),e.cellSize&&(this.cellSize=e.cellSize),e.brushSize&&(this.brushSize=e.brushSize),this.createCanvas(this.docWidth,this.docHeight),this.ctx=this.$el[0].getContext("2d"),this.createImage(this.docWidth,this.docHeight),e.interactive&&this.setupMouseEvents(),this},n.prototype.draw=function(){var e,t,n,r,i;i=this.cellSize,t=this.data.length,e=this.$el[0].getContext("2d");while(i<t){n=this.data[0].length,r=this.cellSize;while(r<n)this.drawCell(r,i,this.data[i][r],this.ctx),r+=this.cellSize;i+=this.cellSize}return this.ctx=e},n.prototype.drawCell=function(e,t,n,r){if(n!==void 0)return r.fillStyle="rgb("+n[0]+", "+n[1]+", "+n[2]+")",r.fillRect(e,t,this.brushSize,this.brushSize)},n.prototype.drawPixelSquare=function(e,t,n,r){return this.drawCell(e,t,n,r),this.drawCell(e+1,t+1,n,r),this.drawCell(e,t+1,n,r),this.drawCell(e+1,t,n,r)},n.prototype.drawImageData=function(e,t,n){var r,i,s,o,u,a,f;this.ctx.drawImage(n,0,0,e,t),o=this.ctx.getImageData(0,0,e,t),a=o.data,f=0,r=0,i=[[]],s=0,u=a.length;while(s<u)i[f][r]=[a[s],a[s+1],a[s+2]],r>=e-1?(r=0,f++,i[f]=[]):r++,s+=this.incriment;return this.data=i,this.ctx.clearRect(0,0,this.docWidth,this.docHeight),this.draw()},n.prototype.createCanvas=function(t,n){return this.$el=e("<canvas width="+t+" height="+n+">"),e("body").append(this.$el),this.$el.height(n),this.$el.width(t)},n.prototype.createImage=function(e,t){var n,r=this;return n=new Image,n.onload=function(){return r.drawImageData(e,t,n)},n.src=this.imgSrc},n.prototype.setupMouseEvents=function(){var t=this;return e("body").mousemove(function(e){var n;return n=t.data[e.pageY][e.pageX],t.drawPixelSquare(e.pageX,e.pageY,n,t.ctx)})},n}()})(jQuery,window,document)}).call(this);